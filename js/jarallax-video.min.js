/*!
 * Video Extension for Jarallax v2.0.4 (https://github.com/nk-o/jarallax)
 * Copyright 2022 nK <https://nkdev.info>
 * Licensed under MIT (https://github.com/nk-o/jarallax/blob/master/LICENSE)
 */ !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).jarallaxVideo=t()}(this,function(){"use strict";/*!
   * Name    : Video Worker
   * Version : 2.0.0
   * Author  : nK <https://nkdev.info>
   * GitHub  : https://github.com/nk-o/video-worker
   */ let e;var t,i=e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(){this.doneCallbacks=[],this.failCallbacks=[]}o.prototype={execute(e,t){let i=e.length;for(t=Array.prototype.slice.call(t);i;)e[i-=1].apply(null,t)},resolve(...e){this.execute(this.doneCallbacks,e)},reject(...e){this.execute(this.failCallbacks,e)},done(e){this.doneCallbacks.push(e)},fail(e){this.failCallbacks.push(e)}};let a=0,l=0,r=0,s=0,n=0,p=new o,d=new o;class u{constructor(e,t){let i=this;i.url=e,i.options_default={autoplay:!1,loop:!1,mute:!1,volume:100,showControls:!0,accessibilityHidden:!1,startTime:0,endTime:0},i.options=i.extend({},i.options_default,t),void 0!==i.options.showContols&&(i.options.showControls=i.options.showContols,delete i.options.showContols),i.videoID=i.parseURL(e),i.videoID&&(i.ID=a,a+=1,i.loadAPI(),i.init())}extend(...e){let t=e[0]||{};return Object.keys(e).forEach(i=>{e[i]&&Object.keys(e[i]).forEach(o=>{t[o]=e[i][o]})}),t}parseURL(e){let t=function e(t){let i=t.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);return!!i&&11===i[1].length&&i[1]}(e),i=function e(t){let i=t.match(/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/);return!!i&&!!i[3]&&i[3]}(e),o=function e(t){let i=t.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/),o={},a=0;return i.forEach(e=>{let t=e.match(/^(mp4|webm|ogv|ogg)\:(.*)/);t&&t[1]&&t[2]&&(o["ogv"===t[1]?"ogg":t[1]]=t[2],a=1)}),!!a&&o}(e);return t?(this.type="youtube",t):i?(this.type="vimeo",i):!!o&&(this.type="local",o)}isValid(){return!!this.videoID}on(e,t){this.userEventsList=this.userEventsList||[],(this.userEventsList[e]||(this.userEventsList[e]=[])).push(t)}off(e,t){this.userEventsList&&this.userEventsList[e]&&(t?this.userEventsList[e].forEach((i,o)=>{i===t&&(this.userEventsList[e][o]=!1)}):delete this.userEventsList[e])}fire(e,...t){this.userEventsList&&void 0!==this.userEventsList[e]&&this.userEventsList[e].forEach(e=>{e&&e.apply(this,t)})}play(e){let t=this;t.player&&("youtube"===t.type&&t.player.playVideo&&(void 0!==e&&t.player.seekTo(e||0),i.YT.PlayerState.PLAYING!==t.player.getPlayerState()&&t.player.playVideo()),"vimeo"===t.type&&(void 0!==e&&t.player.setCurrentTime(e),t.player.getPaused().then(e=>{e&&t.player.play()})),"local"===t.type&&(void 0!==e&&(t.player.currentTime=e),t.player.paused&&t.player.play()))}pause(){let e=this;e.player&&("youtube"===e.type&&e.player.pauseVideo&&i.YT.PlayerState.PLAYING===e.player.getPlayerState()&&e.player.pauseVideo(),"vimeo"===e.type&&e.player.getPaused().then(t=>{t||e.player.pause()}),"local"!==e.type||e.player.paused||e.player.pause())}mute(){let e=this;e.player&&("youtube"===e.type&&e.player.mute&&e.player.mute(),"vimeo"===e.type&&e.player.setVolume&&e.player.setVolume(0),"local"===e.type&&(e.$video.muted=!0))}unmute(){let e=this;e.player&&("youtube"===e.type&&e.player.mute&&e.player.unMute(),"vimeo"===e.type&&e.player.setVolume&&e.player.setVolume(e.options.volume),"local"===e.type&&(e.$video.muted=!1))}setVolume(e=!1){let t=this;t.player&&e&&("youtube"===t.type&&t.player.setVolume&&t.player.setVolume(e),"vimeo"===t.type&&t.player.setVolume&&t.player.setVolume(e),"local"===t.type&&(t.$video.volume=e/100))}getVolume(e){if(!this.player){e(!1);return}"youtube"===this.type&&this.player.getVolume&&e(this.player.getVolume()),"vimeo"===this.type&&this.player.getVolume&&this.player.getVolume().then(t=>{e(t)}),"local"===this.type&&e(100*this.$video.volume)}getMuted(e){if(!this.player){e(null);return}"youtube"===this.type&&this.player.isMuted&&e(this.player.isMuted()),"vimeo"===this.type&&this.player.getVolume&&this.player.getVolume().then(t=>{e(!!t)}),"local"===this.type&&e(this.$video.muted)}getImageURL(e){let t=this;if(t.videoImage){e(t.videoImage);return}if("youtube"===t.type){let i=["maxresdefault","sddefault","hqdefault","0"],o=0,a=new Image;a.onload=function(){120!==(this.naturalWidth||this.width)||o===i.length-1?(t.videoImage=`https://img.youtube.com/vi/${t.videoID}/${i[o]}.jpg`,e(t.videoImage)):(o+=1,this.src=`https://img.youtube.com/vi/${t.videoID}/${i[o]}.jpg`)},a.src=`https://img.youtube.com/vi/${t.videoID}/${i[o]}.jpg`}if("vimeo"===t.type){let l=new XMLHttpRequest;l.open("GET",`https://vimeo.com/api/oembed.json?url=${t.url}`,!0),l.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){let i=JSON.parse(this.responseText);i.thumbnail_url&&(t.videoImage=i.thumbnail_url,e(t.videoImage))}},l.send(),l=null}}getIframe(e){this.getVideo(e)}getVideo(e){let t=this;if(t.$video){e(t.$video);return}t.onAPIready(()=>{let o;if(t.$video||((o=document.createElement("div")).style.display="none"),"youtube"===t.type){t.playerOptions={host:"https://www.youtube-nocookie.com",videoId:t.videoID,playerVars:{autohide:1,rel:0,autoplay:0,playsinline:1}},t.options.showControls||(t.playerOptions.playerVars.iv_load_policy=3,t.playerOptions.playerVars.modestbranding=1,t.playerOptions.playerVars.controls=0,t.playerOptions.playerVars.showinfo=0,t.playerOptions.playerVars.disablekb=1);let a,l;t.playerOptions.events={onReady(e){t.options.mute?e.target.mute():t.options.volume&&e.target.setVolume(t.options.volume),t.options.autoplay&&t.play(t.options.startTime),t.fire("ready",e),t.options.loop&&!t.options.endTime&&(t.options.endTime=t.player.getDuration()-.1),setInterval(()=>{t.getVolume(i=>{t.options.volume!==i&&(t.options.volume=i,t.fire("volumechange",e))})},150)},onStateChange(e){t.options.loop&&e.data===i.YT.PlayerState.ENDED&&t.play(t.options.startTime),a||e.data!==i.YT.PlayerState.PLAYING||(a=1,t.fire("started",e)),e.data===i.YT.PlayerState.PLAYING&&t.fire("play",e),e.data===i.YT.PlayerState.PAUSED&&t.fire("pause",e),e.data===i.YT.PlayerState.ENDED&&t.fire("ended",e),e.data===i.YT.PlayerState.PLAYING?l=setInterval(()=>{t.fire("timeupdate",e),t.options.endTime&&t.player.getCurrentTime()>=t.options.endTime&&(t.options.loop?t.play(t.options.startTime):t.pause())},150):clearInterval(l)},onError(e){t.fire("error",e)}};let r=!t.$video;if(r){let s=document.createElement("div");s.setAttribute("id",t.playerID),o.appendChild(s),document.body.appendChild(o)}t.player=t.player||new i.YT.Player(t.playerID,t.playerOptions),r&&(t.$video=document.getElementById(t.playerID),t.options.accessibilityHidden&&(t.$video.setAttribute("tabindex","-1"),t.$video.setAttribute("aria-hidden","true")),t.videoWidth=parseInt(t.$video.getAttribute("width"),10)||1280,t.videoHeight=parseInt(t.$video.getAttribute("height"),10)||720)}if("vimeo"===t.type){if(t.playerOptions={dnt:1,id:t.videoID,autopause:0,transparent:0,autoplay:t.options.autoplay?1:0,loop:t.options.loop?1:0,muted:t.options.mute?1:0},t.options.volume&&(t.playerOptions.volume=t.options.volume),t.options.showControls||(t.playerOptions.badge=0,t.playerOptions.byline=0,t.playerOptions.portrait=0,t.playerOptions.title=0,t.playerOptions.background=1),!t.$video){let n="";Object.keys(t.playerOptions).forEach(e=>{""!==n&&(n+="&"),n+=`${e}=${encodeURIComponent(t.playerOptions[e])}`}),t.$video=document.createElement("iframe"),t.$video.setAttribute("id",t.playerID),t.$video.setAttribute("src",`https://player.vimeo.com/video/${t.videoID}?${n}`),t.$video.setAttribute("frameborder","0"),t.$video.setAttribute("mozallowfullscreen",""),t.$video.setAttribute("allowfullscreen",""),t.$video.setAttribute("title","Vimeo video player"),t.options.accessibilityHidden&&(t.$video.setAttribute("tabindex","-1"),t.$video.setAttribute("aria-hidden","true")),o.appendChild(t.$video),document.body.appendChild(o)}t.player=t.player||new i.Vimeo.Player(t.$video,t.playerOptions),t.options.startTime&&t.options.autoplay&&t.player.setCurrentTime(t.options.startTime),t.player.getVideoWidth().then(e=>{t.videoWidth=e||1280}),t.player.getVideoHeight().then(e=>{t.videoHeight=e||720});let p;t.player.on("timeupdate",e=>{p||(t.fire("started",e),p=1),t.fire("timeupdate",e),t.options.endTime&&t.options.endTime&&e.seconds>=t.options.endTime&&(t.options.loop?t.play(t.options.startTime):t.pause())}),t.player.on("play",e=>{t.fire("play",e),t.options.startTime&&0===e.seconds&&t.play(t.options.startTime)}),t.player.on("pause",e=>{t.fire("pause",e)}),t.player.on("ended",e=>{t.fire("ended",e)}),t.player.on("loaded",e=>{t.fire("ready",e)}),t.player.on("volumechange",e=>{t.fire("volumechange",e)}),t.player.on("error",e=>{t.fire("error",e)})}if("local"===t.type){t.$video||(t.$video=document.createElement("video"),t.options.showControls&&(t.$video.controls=!0),t.options.mute?t.$video.muted=!0:t.$video.volume&&(t.$video.volume=t.options.volume/100),t.options.loop&&(t.$video.loop=!0),t.$video.setAttribute("playsinline",""),t.$video.setAttribute("muted","muted"),t.$video.setAttribute("webkit-playsinline",""),t.options.accessibilityHidden&&(t.$video.setAttribute("tabindex","-1"),t.$video.setAttribute("aria-hidden","true")),t.$video.setAttribute("id",t.playerID),o.appendChild(t.$video),document.body.appendChild(o),Object.keys(t.videoID).forEach(e=>{!function e(t,i,o){let a=document.createElement("source");a.src=i,a.type=o,t.appendChild(a)}(t.$video,t.videoID[e],`video/${e}`)})),t.player=t.player||t.$video;let d;t.player.addEventListener("playing",e=>{d||t.fire("started",e),d=1}),t.player.addEventListener("timeupdate",function(e){t.fire("timeupdate",e),t.options.endTime&&t.options.endTime&&this.currentTime>=t.options.endTime&&(t.options.loop?t.play(t.options.startTime):t.pause())}),t.player.addEventListener("play",e=>{t.fire("play",e)}),t.player.addEventListener("pause",e=>{t.fire("pause",e)}),t.player.addEventListener("ended",e=>{t.fire("ended",e)}),t.player.addEventListener("loadedmetadata",function(){t.videoWidth=this.videoWidth||1280,t.videoHeight=this.videoHeight||720,t.fire("ready"),t.options.autoplay&&t.play(t.options.startTime)}),t.player.addEventListener("volumechange",e=>{t.getVolume(e=>{t.options.volume=e}),t.fire("volumechange",e)}),t.player.addEventListener("error",e=>{t.fire("error",e)})}e(t.$video)})}init(){let e=this;e.playerID=`VideoWorker-${e.ID}`}loadAPI(){if(l&&r)return;let e="";if("youtube"!==this.type||l||(l=1,e="https://www.youtube.com/iframe_api"),"vimeo"===this.type&&!r){if(r=1,void 0!==i.Vimeo)return;e="https://player.vimeo.com/api/player.js"}if(!e)return;let t=document.createElement("script"),o=document.getElementsByTagName("head")[0];t.src=e,o.appendChild(t),o=null,t=null}onAPIready(e){if("youtube"===this.type&&(void 0!==i.YT&&0!==i.YT.loaded||s?"object"==typeof i.YT&&1===i.YT.loaded?e():p.done(()=>{e()}):(s=1,i.onYouTubeIframeAPIReady=function(){i.onYouTubeIframeAPIReady=null,p.resolve("done"),e()})),"vimeo"===this.type){if(void 0!==i.Vimeo||n)void 0!==i.Vimeo?e():d.done(()=>{e()});else{n=1;let t=setInterval(()=>{void 0!==i.Vimeo&&(clearInterval(t),d.resolve("done"),e())},20)}}"local"===this.type&&e()}}let y;var m=y="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function v(e=m.jarallax){if(void 0===e)return;let t=e.constructor,i=t.prototype.onScroll;t.prototype.onScroll=function(){let e=this;i.apply(e);let t=!e.isVideoInserted&&e.video&&(!e.options.videoLazyLoading||e.isElementInViewport)&&!e.options.disableVideo();t&&(e.isVideoInserted=!0,e.video.getVideo(t=>{let i=t.parentNode;e.css(t,{position:e.image.position,top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",pointerEvents:"none",transformStyle:"preserve-3d",backfaceVisibility:"hidden",margin:0,zIndex:-1}),e.$video=t,"local"===e.video.type&&(e.image.src?e.$video.setAttribute("poster",e.image.src):e.image.$item&&"IMG"===e.image.$item.tagName&&e.image.$item.src&&e.$video.setAttribute("poster",e.image.$item.src)),e.image.$container.appendChild(t),i.parentNode.removeChild(i),e.options.onVideoInsert&&e.options.onVideoInsert.call(e)}))};let o=t.prototype.coverImage;t.prototype.coverImage=function(){let e=o.apply(this),t=!!this.image.$item&&this.image.$item.nodeName;if(e&&this.video&&t&&("IFRAME"===t||"VIDEO"===t)){let i=e.image.height,a=i*this.image.width/this.image.height,l=(e.container.width-a)/2,r=e.image.marginTop;e.container.width>a&&(i=(a=e.container.width)*this.image.height/this.image.width,l=0,r+=(e.image.height-i)/2),"IFRAME"===t&&(i+=400,r-=200),this.css(this.$video,{width:`${a}px`,marginLeft:`${l}px`,height:`${i}px`,marginTop:`${r}px`})}return e};let a=t.prototype.initImg;t.prototype.initImg=function(){let e=this,t=a.apply(e);return(e.options.videoSrc||(e.options.videoSrc=e.$item.getAttribute("data-jarallax-video")||null),e.options.videoSrc)?(e.defaultInitImgResult=t,!0):t};let l=t.prototype.canInitParallax;t.prototype.canInitParallax=function(){let e=this,t=l.apply(e);if(!e.options.videoSrc)return t;let i=new u(e.options.videoSrc,{autoplay:!0,loop:e.options.videoLoop,showControls:!1,accessibilityHidden:!0,startTime:e.options.videoStartTime||0,endTime:e.options.videoEndTime||0,mute:e.options.videoVolume?0:1,volume:e.options.videoVolume||0});function o(){e.image.$default_item&&(e.image.$item=e.image.$default_item,e.image.$item.style.display="block",e.coverImage(),e.onScroll())}if(e.options.onVideoWorkerInit&&e.options.onVideoWorkerInit.call(e,i),i.isValid()){if(this.options.disableParallax()&&(t=!0,e.image.position="absolute",e.options.type="scroll",e.options.speed=1),t){if(i.on("ready",()=>{if(e.options.videoPlayOnlyVisible){let t=e.onScroll;e.onScroll=function(){t.apply(e),e.videoError||!e.options.videoLoop&&(e.options.videoLoop||e.videoEnded)||(e.isVisible()?i.play():i.pause())}}else i.play()}),i.on("started",()=>{e.image.$default_item=e.image.$item,e.image.$item=e.$video,e.image.width=e.video.videoWidth||1280,e.image.height=e.video.videoHeight||720,e.coverImage(),e.onScroll(),e.image.$default_item&&(e.image.$default_item.style.display="none")}),i.on("ended",()=>{e.videoEnded=!0,e.options.videoLoop||o()}),i.on("error",()=>{e.videoError=!0,o()}),e.video=i,!e.defaultInitImgResult&&(e.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7","local"!==i.type))return i.getImageURL(t=>{e.image.bgImage=`url("${t}")`,e.init()}),!1}else e.defaultInitImgResult||i.getImageURL(t=>{let i=e.$item.getAttribute("style");i&&e.$item.setAttribute("data-jarallax-original-styles",i),e.css(e.$item,{"background-image":`url("${t}")`,"background-position":"center","background-size":"cover"})})}return t};let r=t.prototype.destroy;t.prototype.destroy=function(){let e=this;e.image.$default_item&&(e.image.$item=e.image.$default_item,delete e.image.$default_item),r.apply(e)}}return v(),t=()=>{void 0!==m.jarallax&&m.jarallax(document.querySelectorAll("[data-jarallax-video]"))},"complete"===document.readyState||"interactive"===document.readyState?t():document.addEventListener("DOMContentLoaded",t,{capture:!0,once:!0,passive:!0}),m.VideoWorker||(m.VideoWorker=u),v});